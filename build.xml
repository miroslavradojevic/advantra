<project name="advantra" default="" basedir=".">

    <dirname property="module.advantra.basedir" file="${ant.file}"/>

    <description>
    	imagej packages for neuron tracing project build file
    </description>

    <property environment="env"/>
	<property name="src"    		location="src"   />
  	<property name="build"  		location="mybuild" />
	<property name="user.name" 		value="miroslavR" />
   <!-- <property name="javac1.5"        value="javac" />-->  <!-- compiles also if this line is out -->



<target name="main" depends="compress" description="main target">
</target>


<target name="compress" depends="compile" description="generate distribution">

	<jar jarfile="advantra_.jar">
 		<fileset dir="."          includes="plugins.config" />
		<fileset dir="${build}"   includes="**/*.*"         />
 		<manifest>
 			 	     <attribute name="Built-By" value="${user.name}"/>
 		</manifest>
 	</jar>

	<copy file="./advantra_.jar"  toDir="${env.HOME}/ImageJ/plugins/" />
    <copy file="./advantra_.jar"  toDir="${env.HOME}/Fiji.app/plugins/" />

</target>


    <path id="advantra.module.bootclasspath">
        <!-- Paths to be included in compilation bootclasspath -->
        <fileset dir="/home/miroslav/ImageJ/jre_prev/lib/" includes="rt.jar"/>
    </path>


    <path id="advantra.module.production.classpath">
        <pathelement location="${basedir}/../jarlib/ij.jar"/>
        <pathelement location="${basedir}/../jarlib/imagescience.jar"/>
        <pathelement location="${basedir}/../jarlib/flanagan.jar"/>
        <pathelement location="${basedir}/../jarlib/weka.jar"/>
        <pathelement location="${basedir}/../jarlib/ij-plugins-toolkit.jar"/>
        <pathelement location="${basedir}/../jarlib/jama.jar"/>
        <pathelement location="${basedir}/../jarlib/VIB-lib.jar"/>
    </path>

    <path id="advantra.module.sourcepath">
        <dirset dir="${module.advantra.basedir}">
            <include name="src"/>
        </dirset>
    </path>

    <patternset id="compiler.resources">
        <exclude name="**/?*.java"/>
        <exclude name="**/?*.form"/>
        <exclude name="**/?*.class"/>
        <exclude name="**/?*.groovy"/>
        <exclude name="**/?*.scala"/>
        <exclude name="**/?*.flex"/>
        <exclude name="**/?*.kt"/>
        <exclude name="**/?*.clj"/>
    </patternset>

    <target name="compile" description="Compile module advantra">
        <mkdir dir="mybuild"/>
        <javac destdir="mybuild" target="1.6" source="1.6">
            <bootclasspath refid="advantra.module.bootclasspath"/>
            <classpath refid="advantra.module.production.classpath"/>
            <src refid="advantra.module.sourcepath"/>
        </javac>



        <copy todir="mybuild">
            <fileset dir="${module.advantra.basedir}/src">
                <patternset refid="compiler.resources"/>
                <type type="file"/>
            </fileset>
        </copy>
    </target>



</project>
